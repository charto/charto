import L from 'leaflet';

import { LeafletMap } from 'phosphor-leaflet';
import { Projection, CRS, CanvasLayer } from 'charto-leaflet';

export class MapWidget {

	constructor() {
		const JHS180 = new CRS(
			'EPSG:3067',
			new Projection(L.bounds([ -548576, 6291456 ], [ 1548576, 8388608 ]))
		);

		const map = new LeafletMap({
			minZoom: 3,
			maxZoom: 15,
			crs: JHS180
		});

		map.l.addLayer(L.tileLayer('https://tile1.kapsi.fi/mapcache/taustakartta_3067/{z}/{x}/{y}.png', {
			tms: true,
			minZoom: 0,
			maxZoom: Infinity,
			continuousWorld: true,
			noWrap: true
		}));

		setTimeout(() => {
			map.l.invalidateSize(false);
			map.l.setView(L.latLng(7340032, 500000), 2, { animate: false });
		}, 1);

		this.map = map;
	}

	map: LeafletMap;

}
